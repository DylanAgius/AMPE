/*************************************************************************
 *
 * This file is part of the SAMRAI distribution.  For full copyright
 * information, see COPYRIGHT and COPYING.LESSER.
 *
 * Copyright:     (c) 1997-2012 Lawrence Livermore National Security, LLC
 * Description:   Input file for FAC solver tests.
 *
 ************************************************************************/

Main {
  dim = 3
  base_name = "gauss3d"
  do_plot = TRUE
  max_cycles = 15
  residual_tol = 3e-10
  pre_sweeps = 1
  post_sweeps = 3
  max_adaptions = 3
  target_l2norm = 2.6e-4
}

AdaptivePoisson {
  fac_algo = "default"
  problem_name = "multigauss"
  ScalarPoissonOps {
    enable_logging = TRUE
    coarse_solver_choice = "hypre"
    coarse_solver_tolerance = 1e-14
    coarse_solver_max_iterations = 10000
    smoothing_choice = "redblack"
    cf_discretization = "Ewing"
    prolongation_method = "LINEAR_REFINE"
  }
  multigaussian_solution {
    GaussianFcnControl_0 = "{ lambda=-500 cx=0.5 cy=0.5 cz=0.5 }"
    GaussianFcnControl_1 = "{ lambda=-50  cx=0.0 cy=0.5 cz=0.5 }"
    GaussianFcnControl_2 = "{ lambda=-25  cx=0.5 cy=0.0 cz=0.5 }"
    GaussianFcnControl_3 = "{ lambda=-200 cx=0.0 cy=0.0 cz=1.0 }"
  }
  sine_solution {
    SinusoidFcnControl = "{ nx=1.0 px=0.0 ny=1.0 py=0.0 nz=1.0 pz=0.0 }"
  }
  gaussian_solution {
    GaussianFcnControl = "{ lambda=-1000 amp=1 cx=0.5 cy=0.5 cz=0.5 }"
  }
  // finest_plot_level = 0
  adaption_threshold = .0200
}


CartesianGridGeometry {
  // domain_boxes = [(0,0,0), (8,4,8)], [(0,5,0), (4,8,8)]
  domain_boxes = [(0,0,0), (31,31,31)]
  x_lo         = 0, 0, 0
  x_up         = 1, 1, 1
}

StandardTagAndInitialize {
  tagging_method = "GRADIENT_DETECTOR"
}

TreeLoadBalancer {
  report_load_balance = TRUE
  barrier_before = FALSE
  barrier_after = FALSE
  n_root_cycles = 1
}

PatchHierarchy {
   max_levels = 5
   largest_patch_size {
      level_0 = -1, -1, -1
      // all finer levels will use same values as level_0...
   }
   smallest_patch_size {
      level_0 = 8,8,8
      // all finer levels will use same values as level_0...
   }
   ratio_to_coarser {
      level_1            = 2, 2, 2
      level_2            = 3, 3, 3
      level_3            = 3, 3, 3
      level_4            = 3, 3, 3
      level_5            = 3, 3, 3
      level_6            = 3, 3, 3
      level_7            = 3, 3, 3
      level_8            = 3, 3, 3
      level_9            = 3, 3, 3
      //  etc.
   }
   allow_patches_smaller_than_ghostwidth = TRUE
   allow_patches_smaller_than_minimum_size_to_prevent_overlaps = TRUE
}

GriddingAlgorithm {
   enforce_proper_nesting = TRUE
   extend_to_domain_boundary = TRUE
   // load_balance = FALSE
   combine_efficiency = 0.73
   efficiency_tolerance = 0.73
   // write_regrid_boxes = TRUE
   // read_regrid_boxes = TRUE
   // regrid_boxes_filename = "grid"
   check_nonrefined_tags = "IGNORE"
   extend_tags_to_bdry = TRUE
   sequentialize_patch_indices = TRUE
   coalesce_boxes = FALSE
}

TimerManager{
  xx_timer_list = "solv::FACPreconditionerX::*", "solv::ScalarPoissonFacOpsX::*", "solv::CartesianRobinBcHelperX::setBoundaryValuesInCells()_setBcCoefs()"
  timer_list = "solv::*::*"
  print_user = TRUE
  // print_timer_overhead = TRUE
}
